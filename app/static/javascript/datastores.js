// Generated by CoffeeScript 1.8.0
(function() {
  var APP_KEY, client, updateAuthenticationStatus;

  APP_KEY = "ru4mvdp20b2pzu5";

  client = new Dropbox.Client({
    key: APP_KEY
  });

  updateAuthenticationStatus = function(err, client) {
    console.log("ran");
    if (!client.isAuthenticated()) {
      console.log("not logged in");
    } else {
      console.log("logged in!");
      client.getDatastoreManager().openDefaultDatastore(function(error, datastore) {
        if (error) {
          alert("Error opening default datastore: " + error);
        }
        window.gameTable = datastore.getTable("gametable");
        console.log("setting datastore");
        return window.datastore = datastore;
      });
    }
    return client.getAccountInfo(function(err, info) {
      if (err) {
        console.log("there was an erreor", err);
      }
      return window.Info = info._json;
    });
  };

  window.dbclient = client;

  this.updateAuthenticationStatus = updateAuthenticationStatus;

  $(function() {
    return client.authenticate({
      interactive: false
    }, updateAuthenticationStatus);
  });

}).call(this);
